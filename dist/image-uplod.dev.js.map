{"version":3,"sources":["image-uplod.js"],"names":["AWS","require","multer","multerS3","config","update","accessKeyId","process","env","aws_access_key_id","secretAccessKey","aws_secret_access_key","region","s3Client","S3","fileFilter","req","file","cb","mimetype","Error","upload","storage","acl","s3","bucket","key","Date","now","toString","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,SAAD,CAAnB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,QAAD,CAAtB;;AACA,IAAME,QAAQ,GAAGF,OAAO,CAAC,WAAD,CAAxB,C,CAEA;;;AACAD,GAAG,CAACI,MAAJ,CAAWC,MAAX,CAAkB;AACdC,EAAAA,WAAW,EAAEC,OAAO,CAACC,GAAR,CAAYC,iBADX;AAEdC,EAAAA,eAAe,EAAEH,OAAO,CAACC,GAAR,CAAYG,qBAFf;AAGdC,EAAAA,MAAM,EAAE;AAHM,CAAlB;AAOE,IAAIC,QAAQ,GAAG,IAAIb,GAAG,CAACc,EAAR,EAAf;;AAEA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,EAAmB;AACpC,MAAGD,IAAI,CAACE,QAAL,KAAkB,YAAlB,IAAkCF,IAAI,CAACE,QAAL,KAAkB,WAApD,IAAkEF,IAAI,CAACE,QAAL,KAAkB,WAAvF,EACA;AACID,IAAAA,EAAE,CAAC,IAAD,EAAO,IAAP,CAAF;AACH,GAHD,MAKA;AACIA,IAAAA,EAAE,CAAC,IAAIE,KAAJ,CAAU,sCAAV,CAAD,EAAoD,KAApD,CAAF;AACH;AACF,CATD;;AAYA,IAAMC,MAAM,GAAGnB,MAAM,CAAC;AACpBa,EAAAA,UAAU,EAAVA,UADoB;AAEpBO,EAAAA,OAAO,EAAEnB,QAAQ,CAAC;AACdoB,IAAAA,GAAG,EAAE,aADS;AAEdC,IAAAA,EAAE,EAAFA,EAFc;AAGdC,IAAAA,MAAM,EAAE,2DAHM;AAIdC,IAAAA,GAAG,EAAE,aAASV,GAAT,EAAcC,IAAd,EAAoBC,EAApB,EAAuB;AACxBA,MAAAA,EAAE,CAAC,IAAD,EAAOS,IAAI,CAACC,GAAL,GAAWC,QAAX,EAAP,CAAF;AACH;AANa,GAAD;AAFG,CAAD,CAArB;AAYAC,MAAM,CAACC,OAAP,GAAiBV,MAAjB","sourcesContent":["const AWS = require(\"aws-sdk\");\r\nconst multer = require(\"multer\");\r\nconst multerS3 = require(\"multer-s3\")\r\n\r\n//---------------AWS CONFIG----------------------------\r\nAWS.config.update({\r\n    accessKeyId: process.env.aws_access_key_id,\r\n    secretAccessKey: process.env.aws_secret_access_key,\r\n    region: \"us-east-1\"\r\n  })\r\n\r\n  \r\n  var s3Client = new AWS.S3();\r\n\r\n  const fileFilter = (req, file, cb) => {\r\n    if(file.mimetype === 'image/jpeg' || file.mimetype === 'image/png'|| file.mimetype === 'image/jpg')\r\n    {\r\n        cb(null, true);\r\n    }\r\n    else\r\n    {\r\n        cb(new Error('Invalid file type, only JPEG/JPG/PNG'), false)\r\n    }\r\n  }\r\n\r\n\r\n  const upload = multer({\r\n    fileFilter,\r\n    storage: multerS3({\r\n        acl: 'public-read',\r\n        s3,\r\n        bucket: 'apiprojectaws-dev-serverlessdeploymentbucket-ztd99sqpap6i',\r\n        key: function(req, file, cb){\r\n            cb(null, Date.now().toString())\r\n        }\r\n    })\r\n  })\r\n\r\n  module.exports = upload;"],"file":"image-uplod.dev.js"}