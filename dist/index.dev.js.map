{"version":3,"sources":["index.js"],"names":["AWS","require","DynamoDBClient","DynamoDBDocumentClient","GetCommand","PutCommand","express","serverless","config","region","s3Client","S3","app","USERS_TABLE","process","env","client","dynamoDbClient","from","use","json","get","req","res","params","TableName","Key","userId","send","Item","name","status","error","console","log","post","body","paramsBucket","Bucket","ACL","Body","upload","err","data","next","module","exports","handler"],"mappings":"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","sourcesContent":["const AWS = require('aws-sdk');\nconst { DynamoDBClient } = require(\"@aws-sdk/client-dynamodb\");\nconst {\n  DynamoDBDocumentClient,\n  GetCommand,\n  PutCommand,\n} = require(\"@aws-sdk/lib-dynamodb\");\nconst express = require(\"express\");\nconst serverless = require(\"serverless-http\");\n\nAWS.config.region = \"us-east-1\";\nvar s3Client = new AWS.S3();\n\nconst app = express();\n\nconst USERS_TABLE = process.env.USERS_TABLE;\nconst client = new DynamoDBClient();\nconst dynamoDbClient = DynamoDBDocumentClient.from(client);\n\napp.use(express.json());\n\napp.get(\"/users/:userId\", async function (req, res) {\n  const params = {\n    TableName: USERS_TABLE,\n    Key: {\n      userId: req.params.userId,\n    },\n  };\n\n  try {\n    const { Item } = await dynamoDbClient.send(new GetCommand(params));\n    if (Item) {\n      const { userId, name } = Item;\n      res.json({ userId, name });\n    } else {\n      res\n        .status(404)\n        .json({ error: 'Could not find user with provided \"userId\"' });\n    }\n  } catch (error) {\n    console.log(error);\n    res.status(500).json({ error: \"Could not retreive user\" });\n  }\n});\n\napp.post(\"/users\", async function (req, res) {\n  const { userId, name } = req.body;\n  if (typeof userId !== \"string\") {\n    res.status(400).json({ error: '\"userId\" must be a string' });\n  } else if (typeof name !== \"string\") {\n    res.status(400).json({ error: '\"name\" must be a string' });\n  }\n\n  const params = {\n    TableName: USERS_TABLE,\n    Item: {\n      userId: userId,\n      name: name,\n    },\n  };\n\n  try {\n    await dynamoDbClient.send(new PutCommand(params));\n    res.json({ userId, name });\n  } catch (error) {\n    console.log(error);\n    res.status(500).json({ error: \"Could not create user\" });\n  }\n});\n\n\napp.post(\"/createFolder\", function(req, res){\n\n  var paramsBucket = {\n    Bucket: 'apiprojectaws-dev-serverlessdeploymentbucket-ztd99sqpap6i',\n    Key: \"folder-asdfghjkl/\",\n    ACL: \"public-read\",\n    Body: \"body does not matter\"\n  }\n  \n  s3Client.upload(paramsBucket, function(err, data){\n    if(err){\n      console.log(err);\n    }\n    else{\n      console.log(\"Successfully created folder in S3\");\n      console.log(data);\n    }\n  })\n\n})\n\napp.use((req, res, next) => {\n  return res.status(404).json({\n    error: \"Not Found\",\n  });\n});\n\n\nmodule.exports.handler = serverless(app);\n"],"file":"index.dev.js"}