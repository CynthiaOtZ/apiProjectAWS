{"version":3,"sources":["image-uplod.js"],"names":["AWS","require","multer","config","update","multerS3","env","aws_access_key_id","secretAccessKey","process","aws_secret_access_key","region","S3","s3Client","req","file","cb","mimetype","Error","storage","acl","s3","bucket","Date","key","now","toString","module","exports","upload"],"mappings":"aAAA,IAAMA,IAAMC,QAAQ,WACdC,OAASD,QAAQ,UADjBD,SAAaC,QAAC,aAKpBD,IAAIG,OAAOC,OAAO,CAHZC,YAAWJ,QAAQK,IAAAC,kBAKrBC,gBAAiBC,QAAQH,IAAII,sBAC7BC,OAAQ,cAARA,IAAAA,SAAQ,IAAAX,IAAAY,GAINC,WAAeb,SAAGc,EAAtBC,EAAAC,GAGuB,eAAlBD,EAAKE,UAA+C,cAAlBF,EAAKE,UAA6C,cAAlBF,EAAKE,SAAvEF,EAAKE,MAAAA,GAOPD,EAAA,IAAAE,MAAA,yCAAA,IAMDC,OAASd,OAAS,CACde,WAAAA,WACAC,QAFchB,SAAA,CAGdiB,IAAQ,cACLD,GAAAA,GACGC,OAAOC,4DACZC,IAAA,SAAAV,EAAAC,EAAAC,GANYA,EAAA,KAAAO,KAAAE,MAAAC,iBAUnBC,OAAOC,QAAUC","file":"image-uplod.min.js","sourcesContent":["const AWS = require(\"aws-sdk\");\r\nconst multer = require(\"multer\");\r\nconst multerS3 = require(\"multer-s3\")\r\n\r\n//---------------AWS CONFIG----------------------------\r\nAWS.config.update({\r\n    accessKeyId: process.env.aws_access_key_id,\r\n    secretAccessKey: process.env.aws_secret_access_key,\r\n    region: \"us-east-1\"\r\n  })\r\n\r\n  \r\n  var s3Client = new AWS.S3();\r\n\r\n  const fileFilter = (req, file, cb) => {\r\n    if(file.mimetype === 'image/jpeg' || file.mimetype === 'image/png'|| file.mimetype === 'image/jpg')\r\n    {\r\n        cb(null, true);\r\n    }\r\n    else\r\n    {\r\n        cb(new Error('Invalid file type, only JPEG/JPG/PNG'), false)\r\n    }\r\n  }\r\n\r\n\r\n  const upload = multer({\r\n    fileFilter,\r\n    storage: multerS3({\r\n        acl: 'public-read',\r\n        s3,\r\n        bucket: 'apiprojectaws-dev-serverlessdeploymentbucket-ztd99sqpap6i',\r\n        key: function(req, file, cb){\r\n            cb(null, Date.now().toString())\r\n        }\r\n    })\r\n  })\r\n\r\n  module.exports = upload;"]}